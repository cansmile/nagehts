<?php require_once( "heading.php" ); ?>
<!-- 알림 시작 -->
<?php require_once "ready.php"; ?>
<!-- 알림 끝 -->
<section>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 mb-4 mt-2 text-center">
                <h2> Ergänzen Sie die Lücken.<br/>
                    <small> 빈칸을 채우세요. </small>
                    <button type="button" class="btn btn-<?php echo( $color ); ?> ml-2 btn-inline so" id="0">
                        HV
                    </button><br/>
                    [ <small>정답을 입력하면 입력란이 초록색으로 표시되고,<br> 오답이 될 때는 입력란이 붉게
                        표시됩니다.</small> ]
                </h2>
            </div>
        </div>
        <div class="row">
            <div class="col-12 wd_inline_inverted">Frau Miriam Funke im Sprachinstitut TUD hat Mina gemailt. Hier sind
                Fehler (Kommas und Wortstellung) passiert, die rot und kursiv markiert werden. Korrigieren Sie und
                schreiben Sie neu.
                <span class="tran font-weight-bold">&nbsp;<small>TUD 어학원의 미리암 풍케씨는 미나에게 메일을 보냈습니다. 여기에 빨간 글씨 이탤릭체로 표기된 오류 (콤마와 어순)가 있습니다. 올바르게 수정하여 새로 작성해보세요.</small><br/></span>
            </div>
        </div>
        <div class="row lh250">
            <div class="col-sm-12 col-md-6 col-lg-6">
                <div class="row">
                    <div class="col-11 mx-auto border border-dark rounded">
                        Sehr geehrte Frau Mina Kim
                        <span class="tran"><br><small>친애하는 김미나씨,</small><br/></span><br/><br/>
                        vielen Dank für Ihr Interesse an unserem Sprachinstitut.
                        <span class="tran"><br><small>저희 어학원에 관심을 가져주셔서 대단히 감사합니다.</small><br/></span>
                        Es wäre schön wenn wir Sie bei uns begrüßen können.
                        <span class="tran"><br><small>우리가 당신을 맞이할 수 있다면 매우 좋겠습니다.</small><br/></span><br/><br/>
                        <span class="wd_inline_red">Zuerst ich möchte gerne</span> auf den Einstufungstest eingehen.
                        <span class="tran"><br><small>우선 반배치 시험에 대해 언급하고 싶습니다.</small><br/></span><br/><br/>
                        <span class="wd_inline_red">Wenn Sie kommen am Montag zu uns</span>, findet ca. ein 2-stündiger
                        Einstufungstest statt.
                        <span class="tran"><br><small>당신이 월요일에 우리에게 오신다면, 약 2시간이 소요되는 반배치 시험을 실시합니다.</small></span><br/><br/>
                        Dabei Sie werden auf Ihre Grammatik- und Wortschatzkenntnisse sowie auf Ihre Schreibfähigkeiten
                        getestet.
                        <span class="tran"><br><small>시험에서는 문법과 어휘 그리고 쓰기를 다룹니다.</small><br/></span>
                        Sprechen wird nicht geprüft.
                        <span class="tran"><br><small>말하기는 여기에서 시험을 보지 않습니다.</small><br/></span>
                        <span class="wd_inline_red">Je nach Ergebnis wird man</span> Sie dann am nächsten Tag einstufen.
                        <span class="tran"><br><small>결과에 따라서 다음 날 배정이 됩니다.</small><br/></span><br/><br/>
                        <span class="wd_inline_red">Natürlich wir bieten</span> auch B1-Vorbereitungskurse an.
                        <span class="tran"><br><small>물론 B1 준비반도 있습니다.</small><br/></span><br/>
                        Jeder Kurs besteht aus 10 bis 20 Kursteilnehmern.
                        <span class="tran"><br><small>각 그룹은 10명에서 20명 정도의 참여자로 구성됩니다.</small><br/></span>
                        Was die Freizeitangebote betrifft werden viele Programme in Sachen Kultur und Geschichte
                        Dresdens angeboten.
                        <span class="tran"><br><small>여가활동에 관한 것은 드레스덴의 문화와 역사에 대해 다루어집니다.</small><br/></span>
                        Man kann Museen, Konzerte, die Altstadt sowie die Neustadt erleben. Der Preis für die
                        Exkursionen ist in den Sprachkursgebühren enthalten.
                        <span
                            class="tran"><br><small>박물관, 콘서트, 구시가지와 신시가지 등. 현장학습에 대한 비용은 어학비용에 포함되어 있습니다.</small><br/></span>
                        Sie können sich für ein Zimmer in einer WG online auf unserer Homepage anmelden.
                        <span
                            class="tran"><br><small>당신은 우리의 홈페이지에서 플랫쉐어(WG) 내의 방을 신청하실 수 있습니다.</small><br/></span><br/><br/>
                        <span class="wd_inline_red">Wenn_Sie noch Fragen haben</span> stehen wir Ihnen jederzeit zur
                        Verfügung.
                        <span class="tran"><br><small>궁금하신 사항이 있으시면, 언제든 우리에게 문의해주세요.</small><br/></span><br/><br/>
                        <span class="wd_inline_red">Auf Ihre Antwort wir freuen uns sehr.</span>
                        <span class="tran"><br><small>답장을 주시면 매우 감사하겠습니다.</small><br/></span><br/><br/>
                        Mit freundlichen Grüßen
                        <span class="tran"><br><small>인사를 전하며</small><br/></span><br/><br/>
                        Miriam Funke
                        <span class="tran"><br><small>미리암 풍케</small><br/></span><br/>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6">
                <div class="row">
                    <div class="col-11 mx-auto border border-dark rounded">
                        Sehr geehrte Frau Mina Kim
                        <br/><br/>
                        vielen Dank für Ihr Interesse an unserem Sprachinstitut.

                        Es wäre schön wenn wir Sie bei uns begrüßen können.
                        <br/><br/>
                        <div class="input-group"><input type="text" style="max-width: 80px; min-width: 80px;"
                                                        class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                                        placeholder="Antwort" aria-label="Antwort" id="qst-1">
                            auf den Einstufungstest eingehen.
                            <br/><br/>
                        </div>
                        <div class="input-group"><input type="text" style="max-width: 80px; min-width: 80px;"
                                                        class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                                        placeholder="Antwort" aria-label="Antwort" id="qst-2">
                            , findet ca. ein 2-stündiger Einstufungstest statt.
                            <br/>
                            <br/>
                        </div>
                        Dabei Sie werden auf Ihre Grammatik- und Wortschatzkenntnisse sowie auf Ihre Schreibfähigkeiten getestet.
                        Sprechen wird nicht geprüft.
                        <div class="input-group"><input type="text" style="max-width: 80px; min-width: 80px;"
                                                        class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                                        placeholder="Antwort" aria-label="Antwort" id="qst-3">
                            Sie dann am nächsten Tag einstufen.
                            <br/><br/>
                        </div>
                        <div class="input-group"><input type="text" style="max-width: 80px; min-width: 80px;"
                                                        class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                                        placeholder="Antwort" aria-label="Antwort" id="qst-4">
                            auch B1-Vorbereitungskurse an.
                        </div>
                        Jeder Kurs besteht aus 10 bis 20 Kursteilnehmern.

                        Was die Freizeitangebote betrifft werden viele Programme in Sachen Kultur und Geschichte
                        Dresdens angeboten.

                        Man kann Museen, Konzerte, die Altstadt sowie die Neustadt erleben. Der Preis für die
                        Exkursionen ist in den Sprachkursgebühren enthalten.
                        Sie können sich für ein Zimmer in einer WG online auf unserer Homepage anmelden.<br/><br/>
                        <div class="input-group"><input type="text" style="max-width: 80px; min-width: 80px;"
                                                        class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                                        placeholder="Antwort" aria-label="Antwort" id="qst-5">
                            stehen wir Ihnen jederzeit zur Verfügung.
                            <br/><br/>
                        </div>
                        <div class="input-group">
                            <input type="text" style="max-width: 80px; min-width: 80px;"
                                   class="form-control q rounded-0 border border-dark border-bottom-only mx-1 px-2 py-1"
                                   placeholder="Antwort" aria-label="Antwort" id="qst-6">
                            <br/><br/>
                        </div>
                        Mit freundlichen Grüßen
                        <br/><br/>
                        Miriam Funke
                        <br/>
                    </div>
                </div>
            </div>
        </div>
        <!-- 정답화인 버튼 시작 -->
        <div class="row">
            <div class="btn my-3 btn-light col-sm-12 col-md-12 col-lg-12" id="chk">
                정답확인
            </div>
        </div>
        <!-- 정답확인 버튼 끝 -->
        <div class="row">
            <div class="col-12"><span class="tipp">TIPP</span></div>
            <div class="col-12 h5 my-3">콤마 (흘림체) Kommasetzung (kursiv)</div>
            <div class="col-12">
                <ul>
                    <li>사적 및 준 공식적 이메일에서 인사말 뒤에 반드시 콤마(,)가 온다.</li>
                    <li>독일어에서 주문장과 부문장 사이에 항상 콤마(,)가 온다.</li>
                </ul>
            </div>
            <div class="col-12 h5 my-3">어순 (동사의 위치) Wortstellungen der Verben (<span class="wd_inline_inverted">&nbsp;&nbsp;</span>로 표시) </div>
            <div class="col-12">
                <ul>
                    <li>부사(zuerst, natürlich), 형용사, 전치사구 그리고 대등접속사(deshalb, daher, also, denn 등)가 문장 앞에 나올 때는 동사는 문장 두번째에 오고 주어는 세 번째 자리에 위치한다. </li>
                    <li>종속접속사가 이끄는 종속절에서는 동사가 맨 뒤에 온다. </li>
                </ul>
            </div>
            <div class="col-12 h5 my-3">Konnektoren</div>
            <div class="col-12">
                <ul>
                    <li>접속사에는 조건의 의미 wenn, 주절과 목적절을 이끄는 dass, 시간 의미의 wenn, als, während, nachdem, bevor가 있고 인과적 의미의 weil, da와 목적의 의미의 damit 그리고 양보의 의미의 obwohl등이 있다.</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<div id="last" class="d-none"></div>

<?php require "footer.php"; ?>
<script src="./dev/js/howler.core.js"></script>
<!-- 맞고 틀리는지 소리 -->
<?php require_once( "./dev/oxsound.php" ); ?>
<script>
    $("#0").hide();
    $(".tran").hide();
    $(".ant").hide();
    var an = new Array();
    var an = ["Zuerst möchte ich gerne", "Wenn Sie am Montag zu uns kommen", "Je nach Ergebnis wird man", "Natürlich bieten wir", "Wenn Sie noch Fragen haben", "Auf Ihre Antwort freuen wir uns sehr."];
    /* 각 문장 재생 횟수 초기화 */
    var hm = new Array(),
        sen = new Array();
    $(".so").each(function () {
        hm[$(this).attr("id")] = 0;
        sen[$(this).attr("id")] = $("#" + $(this).attr("id"))
            .html();
    });

    $(document).ready(function () {
        /* 소리 출력 전역 변수와 함수 */
        var sen = new Array(),
            pa = new Array(),
            he = new Array(),
            last;
        $(".so").each(function () {
            var t = $(this);
            var ti = t.attr("id");
            sen[ti] = 0;
            pa[ti] = t.html();
        });

        function stopAll() {
            $(".so").each(function () {
                $(this).html(pa[$(this).attr("id")]);
            });
        } /* 문제 재생 */
        var nagehts = new Howl({
            src: ["./dev/sounds/Reihe 11/r11 B2.mp3"],
            sprite: {
                "0": [460, 116403]
            },
            html5: true,
            volume: 1,
            format: "mp3",
            preload: true,
            onloaderror: function () {
                $(".alert").append(
                    "<br /><strong class=\"font-weight-bold text-dark display-4\">페이지를 다시 읽어주시기 바래요.</strong>"
                );
                console.log("다시 읽어주세요!");
            },
            onload: function () {
                /* 음성 준비되면 HV 버튼 나타내기 */
                $("#0").show();
                $(".alert").hide();
                $(".so").on("click", function () {
                    var t = $(this);
                    var ti = t.attr("id");
                    if (($("div#last").text() == "" || t.text() == "❚❚") && !t.hasClass(
                        ".itm-lst")) {
                        $("#last").text(ti);
                        t.text("■");
                        nagehts.seek();
                        nagehts.play(ti);
                        sen[ti]++;
                        last = ti;
                        $("#cnt-" + ti).text(sen[ti]);
                    } else if (last == ti && nagehts.playing($("div#last").text())) {
                        $("#last").text("");
                        t.html(pa[ti]);
                        nagehts.pause();
                        sen[ti]--;
                        $("#cnt-" + ti).text(sen[ti]);
                    }
                });

                /* 값 확인해보자, io값이 참이면 전체 검사 */
                function rfchk(th, io) {
                    var q, qn, a, b, fl;
                    q = th.val().length;
                    qn = (th.attr("id").substr(4)) - 1;
                    a = th.val();
                    a = a.replace(/ /gi, "");
                    di(th);
                    if (!$.isArray(an[qn])) {/* 1 인 경우 */
                        if (io) {
                            b = an[qn];
                        } else {
                            b = an[qn].substr(0, q);
                        }
                        b = b.replace(/ /gi, "");
                        if (a == b) {
                            return true;
                        }
                    } else {/* 2 이상인 경우 */
                        for (var fd = 0; fd < an[qn].length; fd++) {
                            if (io) {
                                b = an[qn][fd];
                            } else {
                                b = an[qn][fd].substr(0, q);
                            }
                            b = b.replace(/ /gi, "");
                            if (a == b) {
                                return true;
                            }
                        }
                    }
                }

                /* 역동적 입력란 */
                function di(th) {
                    var le = 0, mp = 8, l = th.val().length;
                    if (l < 5) {
                        var mp = 10;
                    } else if (l > 30) {
                        var mp = 6;
                    } else if (l < 30) {
                        var mp = 8;
                    } else {
                        var mp = 8;
                    }
                    if (l >= 5) {
                        le = l;
                    } else {
                        le = 5;
                    }
                    var w = (le + 1) * mp + "px";
                    th.addClass("mx-1");
                    th.css("min-width", w);
                    th.css("max-width", w);
                    th.css("width", w);
                };

                $(".q").on("keyup", function () {
                    $(this).removeClass("bg-danger");
                    $(this).removeClass("bg-success");
                    $("#ant-" + $(this).attr("id").substr(4)).removeClass("text-danger");
                    $("#ant-" + $(this).attr("id").substr(4)).removeClass("text-success");
                    if (rfchk($(this))) {
                        $(this).addClass("text-white font-weight-bold");
                        $(this).addClass("bg-success");
                        $("#ant-" + $(this).attr("id").substr(4)).addClass("text-success");
                    } else {
                        $(this).addClass("text-white font-weight-bold");
                        $(this).addClass("bg-danger");
                        $("#ant-" + $(this).attr("id").substr(4)).addClass("text-danger");
                    }
                    if (!$(this).val()) {
                        $(this).removeClass("bg-danger");
                        $(this).removeClass("bg-success");
                        $(this).removeClass("text-white font-weight-bold");
                    }
                    if ($(this).val()) {
                        $("#ant-" + $(this).attr("id").substr(4)).show();
                        $("#ant-" + $(this).attr("id").substr(4)).text($(this).val());
                    } else {
                        $("#ant-" + $(this).attr("id").substr(4)).hide();
                    }
                });
                $(".q").on("focusin", function () {
                    $("#ant-" + $(this).attr("id").substr(4)).show();
                    if (!$("#ant-" + $(this).attr("id").substr(4)).text()) {
                        $("#ant-" + $(this).attr("id").substr(4)).text($(this).val());
                    }
                    if ($("#ant-" + $(this).attr("id").substr(4)).text()) {
                        if (rfchk($(this))) {
                            $(this).addClass("text-white font-weight-bold");
                            $(this).addClass("bg-success");
                            $("#ant-" + $(this).attr("id").substr(4)).addClass("text-success");
                        } else {
                            $(this).addClass("text-white font-weight-bold");
                            $(this).addClass("bg-danger");
                            $("#ant-" + $(this).attr("id").substr(4)).addClass("text-danger");
                        }
                    }
                });
                $(".q").on("focusout", function () {
                    $("#ant-" + $(this).attr("id").substr(4)).hide();
                    if (rfchk($(this), true)) {
                        $(this).addClass("bg-success");
                        $(this).addClass("text-white");
                    } else {
                        $(this).addClass("bg-danger");
                    }
                    if ($(this).val()) {
                        if ($(this).hasClass("bg-danger")) {
                            x.play();
                        } else if ($(this).hasClass("bg-success")) {
                            o.play();
                            $(this).prop("disabled", true);
                        }
                    }
                    $(this).removeClass("bg-danger");
                    if (!$(this).attr("disabled")) {
                        $(this).removeClass("text-white font-weight-bold");
                        $(this).removeClass("bg-success");
                    }
                })
                /* 입력하는 문자 확인(정답 표시 없음) 여기까지 */
                $("#chk").on("click", function () {
                    var na = "";
                    var ri = 0;
                    var qst = $(".q").length;
                    $(".q").each(function () {
                        if (na != "") {
                            na += ", ";
                        }
                        if ($(this).val() == "") {
                            na += $(this).attr("id").substr(4, 1);
                        }
                    });
                    if ($(this).attr("id") == "done") {
                    } else if (na == "") {
                        for (var i = 0; i < an.length; i++) {
                            var oran = $("#qst-" + (i + 1)).val();
                            if (rfchk($("#qst-" + (i + 1)), true)) {
                                $("#qst-" + (i + 1)).addClass("cr");
                                $("#qst-" + (i + 1)).removeClass("rounded-0");
                            } else {
                                $("#qst-" + (i + 1)).val(oran);
                                $("#qst-" + (i + 1)).attr("disabled", true);
                                $("#qst-" + (i + 1)).addClass("wa");
                                $("#qst-" + (i + 1)).removeClass("rounded-0");
                                if (!$.isArray(an[i])) {
                                    $("#qst-" + (i + 1)).after(
                                        "<div class=\"d-block ra t-6\" style=\"max-width: 100px;\">" +
                                        an[i] + "</div>");
                                } else {
                                    /* 2 이상인 경우 */
                                    var r =
                                        "<div class=\"d-block ra t-6\" style=\"max-width: 100px;\">";
                                    for (var fd = (an[i].length - 1); fd >= 0; fd--) {
                                        if (fd < (an[i].length - 1)) {
                                            r = r + " / ";
                                        }
                                        r = r + an[i][fd];
                                    }
                                    r = r + "</div>";
                                    if ($("span.sen").length > 0) {
                                        $("#qst-" + (i + 1)).closest("span.sen").after(
                                            r);
                                    } else {
                                        $("#qst-" + (i + 1)).after(r);
                                    }
                                }
                            }
                            if ($("#qst-" + (i + 1)).hasClass("bg-success")) {
                                ri++;
                            }
                        }
                        ; /* 정답 확인 div 상자 배경색 속성 없애기 */
                        $(this).removeClass("btn-light ");
                        var qa = $(".q").length; /* 전체 문항 수 */
                        var qr = $(".bg-success").length; /* 맞춘 항목 수 */
                        var pe = (qr / qa) * 100; /* 정답 비율 */
                        var tcl = "white"; /* 기본 문자색 */
                        /* 분류 기준은 100%, 80%, 60%, 40% */
                        if (pe > 99) {
                            var st = "원어민이세요?";
                            var cl = "lime";
                            var tcl = "dark";
                        } else if (pe > 74) {
                            var st = "어! 좀 하시는데요~^^";
                            var cl = "success";
                        } else if (pe > 49) {
                            var st = "쓰읍~ 다시 해 보실까요?";
                            var cl = "primary";
                        } else {
                            var st = "좀 더 분발해 주세요~";
                            var cl = "danger";
                        }
                        $(this).addClass("btn-" + cl + " text-" + tcl);
                        $(this).html("<h4>" + qa + "문제 중 " + qr + "개를 맞히셨네요!<br>" + st +
                            "</h4>");
                        $(this).prop("disabled", true);
                        $(".tran").show();
                        $(this).attr("id", "done");
                    } else {
                        alert("모든 문제를 풀어주세요!");
                    }
                    ;
                });
                var pan = new Array();
                pan = [1, 6, 15, 19, 21];
                for (var p = 0; p < pan.length; p++) {
                    var pann = "#qst-" + pan[p];
                    $(pann).val(an[(pan[p] - 1)]);
                    $(pann).addClass("bg-success text-white font-weight-bold");
                    $(pann).prop("disabled", true);
                    di($(pann));
                }
                $("#0").show();
                $(".alert").hide();

            },
            onend: function () {
                $("div#last").text("");
                stopAll();
                $("#cnt-" + last).text(sen[last]);
                if (last == 0) {
                    if (sen[last] == 3) {
                        $(".tran").show();
                        $(".so").each(function () {
                            pa[last] = $("#" + last).html();
                        });
                    }
                } else if (sen[last] == 3) {
                    if ($("#" + last).hasClass("itm")) {
                        $("#" + last + ">.tran").show();
                    }
                    $("#" + last).closest("tr").find(".tran").show();
                    pa[last] = $("#" + last).html();
                }
            }
        });
    });
</script>
</body>

</html>
